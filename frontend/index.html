<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>EcoPackAI | AI Packaging Dashboard</title>

<!-- Bootstrap -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<!-- Google Font -->
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

<style>
* { font-family: 'Poppins', sans-serif; }

/* ===== GLOBAL ===== */
body {
    background: linear-gradient(120deg, #0f2027, #203a43, #2c5364);
    color: #e0e0e0;
    min-height: 100vh;
}

/* ===== SIDEBAR ===== */
.sidebar {
    background: linear-gradient(180deg, #0b1d26, #102a43);
    color: #ffffff;
    padding: 30px;
    height: 100vh;
    animation: slideInLeft 1s ease;
}

.sidebar label { color: #b2dfdb; }

.sidebar input,
.sidebar select {
    background-color: #1c2b36;
    color: #e0e0e0;
    border: 1px solid #37474f;
}

.sidebar input::placeholder {
    color: #9ea7ad;
}

/* ===== BUTTON ===== */
.btn-ai {
    background: linear-gradient(135deg, #26a69a, #2bbbad);
    border: none;
    color: white;
    font-weight: 600;
}

.btn-ai:hover {
    background: linear-gradient(135deg, #1de9b6, #00bfa5);
}

/* ===== DASHBOARD ===== */
.dashboard {
    padding: 30px;
    animation: fadeIn 1s ease;
}

/* ===== CARDS ===== */
.card {
    background-color: #1c2b36;
    border-radius: 15px;
    box-shadow: 0 10px 25px rgba(0,0,0,0.6);
    color: #e0e0e0;
}

.card h4, .card h5, .card h6 {
    color: #b2dfdb;
}

/* ===== TABLE ===== */
.table {
    color: #e0e0e0;
}

.table thead {
    background-color: #102a43;
}

.table th {
    color: #80cbc4;
    border-color: #37474f;
}

.table td {
    border-color: #37474f;
}

/* ===== CHARTS ===== */
canvas {
    max-height: 260px;
    background-color: #1c2b36;
    border-radius: 10px;
    padding: 10px;
}

/* ===== ANIMATIONS ===== */
@keyframes slideInLeft {
    from { transform: translateX(-100px); opacity: 0; }
    to { transform: translateX(0); opacity: 1; }
}

@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}
</style>
</head>

<body>

<div class="container-fluid">
<div class="row">

<!-- ================= LEFT INPUT PANEL ================= -->
<div class="col-md-3 sidebar">
    <h3>üå± EcoPackAI</h3>
    <p>AI-Powered Sustainable Packaging</p>
    <hr>

    <label>Product Name</label>
    <input type="text" id="product_name" class="form-control mb-2"
           placeholder="e.g. Snack Packaging">

    <label>Quantity</label>
    <input type="number" id="quantity" class="form-control mb-2" value="1000">

    <label>Strength Requirement</label>
    <select id="strength" class="form-select mb-2">
        <option value="3">Low</option>
        <option value="6">Medium</option>
        <option value="9">High</option>
    </select>

    <label>Weight Capacity</label>
    <input type="number" id="weight_capacity" class="form-control mb-2" value="5">

    <label>Biodegradability (1‚Äì10)</label>
    <input type="number" id="biodegradability" class="form-control mb-2" value="8">

    <label>Recyclability (%)</label>
    <input type="number" id="recyclability" class="form-control mb-2" value="90">

    <label>Cost Efficiency (0‚Äì1)</label>
    <input type="number" step="0.1" id="cost_efficiency" class="form-control mb-3" value="0.75">

    <button class="btn btn-ai w-100" onclick="getAIRecommendation()">
        üöÄ Get AI Recommendation
    </button>
</div>

<!-- ================= RIGHT DASHBOARD ================= -->
<div class="col-md-9 dashboard">

    <h4 class="mb-4">üìä AI Recommendation Dashboard</h4>

    <!-- SUMMARY CARDS -->
    <div class="row mb-4">
        <div class="col-md-4">
            <div class="card p-3 text-center">
                <h6>Top Material</h6>
                <h4 id="topMaterial">‚Äì</h4>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card p-3 text-center">
                <h6>Total Cost</h6>
                <h4 id="topCost">‚Äì</h4>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card p-3 text-center">
                <h6>AI Score</h6>
                <h4 id="topScore">‚Äì</h4>
            </div>
        </div>
    </div>

    <!-- TABLE -->
    <div class="card p-3 mb-4">
        <h5>üèÜ Recommended Materials</h5>
        <table class="table table-striped text-center">
            <thead>
                <tr>
                    <th>Rank</th>
                    <th>Material</th>
                    <th>Unit Cost</th>
                    <th>Total Cost</th>
                    <th>AI Score</th>
                </tr>
            </thead>
            <tbody id="resultTable"></tbody>
        </table>
    </div>

    <!-- CHARTS -->
    <div class="row">
        <div class="col-md-6">
            <div class="card p-3">
                <h6>üí∞ Cost Comparison</h6>
                <canvas id="costChart"></canvas>
            </div>
        </div>
        <div class="col-md-6">
            <div class="card p-3">
                <h6>ü§ñ AI Score Comparison</h6>
                <canvas id="scoreChart"></canvas>
            </div>
        </div>
    </div>

</div>
</div>
</div>

<script>
let costChart, scoreChart;

function getAIRecommendation() {

    const data = {
        product_name: product_name.value,
        quantity: Number(quantity.value),
        strength_encoded: Number(strength.value),
        weight_capacity: Number(weight_capacity.value),
        biodegradability_score: Number(biodegradability.value),
        recyclability_percent: Number(recyclability.value),
        cost_efficiency_score: Number(cost_efficiency.value)
    };

    fetch("http://127.0.0.1:5000/recommend", {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify(data)
    })
    .then(res => res.json())
    .then(result => {

        const recs = result.recommendations;

        topMaterial.innerText = recs[0].material_name;
        topCost.innerText = recs[0].total_cost.toFixed(2);
        topScore.innerText = recs[0].ai_recommendation_score.toFixed(2);

        resultTable.innerHTML = "";

        const labels = [];
        const costs = [];
        const scores = [];

        recs.forEach((r, i) => {
            labels.push(r.material_name);
            costs.push(r.total_cost);
            scores.push(r.ai_recommendation_score);

            resultTable.innerHTML += `
                <tr>
                    <td>${i+1}</td>
                    <td>${r.material_name}</td>
                    <td>${r.predicted_unit_cost.toFixed(2)}</td>
                    <td>${r.total_cost.toFixed(2)}</td>
                    <td>${r.ai_recommendation_score.toFixed(2)}</td>
                </tr>
            `;
        });

        if (costChart) costChart.destroy();
        if (scoreChart) scoreChart.destroy();

        costChart = new Chart(document.getElementById("costChart"), {
            type: "bar",
            data: {
                labels: labels,
                datasets: [{ label: "Total Cost", data: costs }]
            }
        });

        scoreChart = new Chart(document.getElementById("scoreChart"), {
            type: "line",
            data: {
                labels: labels,
                datasets: [{ label: "AI Score", data: scores }]
            }
        });

    });
}
</script>

</body>
</html>
